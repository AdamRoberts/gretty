ext {
  generateSources = true
  generateJavadoc = true
  groovy_version = '2.1.9'
}

allprojects {
  group = 'org.akhikhl.gretty'
  version = '0.0.2'
}

subprojects {

  apply plugin: 'maven'

  repositories {
    mavenLocal()
    mavenCentral()
  }

  afterEvaluate {
  
    if(plugins.findPlugin('java')) {
      sourceCompatibility = '1.7'
      targetCompatibility = '1.7'
    }
  
    if(generateSources && tasks.findByName('classes')) {
      task sourcesJar(type: Jar, dependsOn: classes) {
        classifier = 'sources'
        from sourceSets.main.allSource
      }
      artifacts {
        archives sourcesJar
      }
    }

    if(generateJavadoc && tasks.findByName('javadoc')) {
      task javadocJar(type: Jar) {
        dependsOn javadoc
        classifier = 'javadoc'
        from javadoc.destinationDir
        if(tasks.findByName('groovydoc')) {
          dependsOn groovydoc
          from groovydoc.destinationDir
        }
      }
      artifacts {
        archives javadocJar
      }
    }
  }
}

defaultTasks 'install'

